@using PerfumeShop.Domain.Models
@model Cart
@{
    Layout = "_ShopLayout";
}

<style>
    /* ===== LUXURY STYLE ===== */
    .cart-wrapper {
        padding: 30px;
        margin-top: 20px;
    }

    .cart-title {
        font-size: 28px;
        font-weight: 700;
        color: #111;
        margin-bottom: 25px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .cart-box {
        background: #fff;
        border-radius: 14px;
        padding: 25px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.06);
    }

    .cart-item {
        border-bottom: 1px solid #f0f0f0;
        padding: 18px 0;
        display: flex;
        align-items: center;
        gap: 25px;
    }

        .cart-item:last-child {
            border-bottom: none;
        }

    .item-img {
        width: 90px;
        height: 90px;
        border-radius: 10px;
        object-fit: cover;
    }

    .item-name {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 5px;
        color: #111;
    }

    .item-price {
        color: #d10000;
        font-weight: 600;
    }

    /* Quantity controls */
    .qty-control {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .qty-btn {
        width: 34px;
        height: 34px;
        border-radius: 50%;
        border: 1px solid #ccc;
        background: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        cursor: pointer;
        transition: 0.2s;
    }

        .qty-btn:hover {
            background: #111;
            color: white;
        }

    .qty-number {
        min-width: 28px;
        text-align: center;
        font-weight: 700;
    }

    .remove-btn {
        background: none;
        border: none;
        color: #d10000;
        font-weight: bold;
        cursor: pointer;
        font-size: 18px;
    }

    /* Summary box */
    .summary-box {
        margin-top: 25px;
        background: #fff;
        padding: 25px;
        border-radius: 14px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.06);
        text-align: right;
    }

        .summary-box h4 {
            font-size: 22px;
            font-weight: 700;
        }

    .checkout-btn {
        padding: 12px 30px;
        font-size: 17px;
        border-radius: 10px;
        background: #111;
        color: white;
        border: none;
        margin-top: 15px;
        transition: 0.2s;
    }

        .checkout-btn:hover {
            background: #333;
        }
    /* ===== POPUP LUXURY ===== */
    .swal-luxury {
        border-radius: 18px !important;
        padding: 25px !important;
        box-shadow: 0 8px 30px rgba(0,0,0,0.15) !important;
        animation: fadeInUp 0.35s ease-out !important;
    }

    /* Icon Warning mềm hơn */
    .swal2-icon.swal2-warning {
        border-color: #f7c46c !important;
        color: #d48a00 !important;
    }

    /* Nút XÓA Luxury */
    .swal-confirm-btn {
        background: linear-gradient(135deg, #d10000, #ff4d4d) !important;
        color: white !important;
        border-radius: 10px !important;
        font-size: 15px !important;
        padding: 10px 25px !important;
        border: none !important;
        box-shadow: 0 4px 12px rgba(209, 0, 0, 0.3) !important;
        transition: 0.25s !important;
    }

        .swal-confirm-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(209, 0, 0, 0.45) !important;
        }

    /* Nút HỦY Luxury */
    .swal-cancel-btn {
        background: #f3f3f3 !important;
        color: #333 !important;
        border-radius: 10px !important;
        font-size: 15px !important;
        padding: 10px 25px !important;
        border: none !important;
        transition: 0.25s !important;
    }

        .swal-cancel-btn:hover {
            background: #e8e8e8 !important;
        }

    /* Hiệu ứng hiển thị mượt */
    @@keyframes fadeInUp {
        from

    {
        transform: translateY(25px);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }

    }

    /* Hiệu ứng SweetAlert tuỳ chỉnh */
    .swal2-show-custom {
        animation: fadeInUp 0.35s ease-out !important;
    }

    .swal2-hide-custom {
        animation: fadeOutDown 0.25s ease-in !important;
    }

    @@keyframes fadeOutDown {
        from

    {
        transform: translateY(0);
        opacity: 1;
    }

    to {
        transform: translateY(25px);
        opacity: 0;
    }

    }

</style>


<div class="container cart-wrapper">

    <h2 class="cart-title">
         Giỏ hàng của bạn
    </h2>

    @if (Model.Items.Count == 0)
    {
        <div class="alert alert-light border p-4 text-center">
            <h5>Giỏ hàng trống</h5>
            <a href="/Shop" class="btn btn-dark mt-2 px-4">Tiếp tục mua sắm</a>
        </div>
        return;
    }

    <div class="cart-box">

        @foreach (var item in Model.Items)
        {
            <div class="cart-item">

  
                <img src="@item.Product.ImageUrl" class="item-img" />

                <div class="flex-grow-1">
                    <div class="item-name">@item.Product.Name</div>
                    <div class="item-price">@item.Product.Price.ToString("N0") đ</div>
                </div>

  
                <div class="qty-control">
                    <form method="post" action="/Cart/Decrease">
                        <input type="hidden" name="productId" value="@item.ProductId" />
                        <button class="qty-btn">−</button>
                    </form>

                    <span class="qty-number">@item.Qty</span>

                    <form method="post" action="/Cart/Increase">
                        <input type="hidden" name="productId" value="@item.ProductId" />
                        <button class="qty-btn">+</button>
                    </form>
                </div>

          
                <div class="item-price" style="width:150px; text-align:right;">
                    @((item.Product.Price* item.Qty).ToString("N0")) đ
                </div>

             
                <a onclick="confirmDelete(@item.ProductId)" class="remove-btn">×</a>


            </div>
        }
    </div>

 
    <div class="summary-box">
        <h4>
            Tổng cộng:
            <span class="text-danger">
                @((Model.Items.Sum(x => x.Product.Price * x.Qty)).ToString("N0")) đ
            </span>
        </h4>

        <a href="/Order/Checkout">
            <button class="checkout-btn">Tiến hành đặt hàng</button>
        </a>
    </div>

</div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    function confirmDelete(id) {
        Swal.fire({
            title: "Xóa sản phẩm?",
            html: `
                <div style='font-size:16px; color:#555; margin-top:5px'>
                    Bạn có chắc chắn muốn xóa sản phẩm này khỏi giỏ hàng?
                </div>
            `,
            icon: "warning",

            background: "#ffffff",
            color: "#111",


            showClass: {
                popup: "swal2-show-custom"
            },
            hideClass: {
                popup: "swal2-hide-custom"
            },


            customClass: {
                popup: "swal-luxury",
                confirmButton: "swal-confirm-btn",
                cancelButton: "swal-cancel-btn"
            },

            showCancelButton: true,
            confirmButtonText: "Xóa",
            cancelButtonText: "Hủy"
        }).then((result) => {
            if (result.isConfirmed) {
                window.location = "/Cart/Remove?productId=" + id;
            }
        });
    }

</script>

